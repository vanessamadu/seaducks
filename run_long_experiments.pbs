#!/bin/bash
#PBS -l walltime=5:00:00
#PBS -l select=1:ncpus=2:mem=2gb
#PBS -J 1-400

module load anaconda3/personal
eval "$(mamba shell hook --shell bash)"
export MAMBA_ROOT_PREFIX="$HOME/anaconda3"
mamba activate SeaDucks

cd $PBS_O_WORKDIR

python experiments/hpc_scripts/fit_mvn_ngboost_by_id.py ${PBS_ARRAY_INDEX} > full_experiment_${PBS_ARRAY_INDEX}_early_stopping_50_logs

# copy files back
full_experiment_{index}_early_stopping_50
mv full_experiment_${PBS_ARRAY_INDEX}_early_stopping_50_logs experiments/mvn_ngboost_fit_experiments/early_stopping_50/20-01-2025_100_replications/experiment_logs
mv full_experiment_${PBS_ARRAY_INDEX}_early_stopping_50.p experiments/mvn_ngboost_fit_experiments/early_stopping_50/20-01-2025_100_replications/fit_models
mv full_experiment_${PBS_ARRAY_INDEX}_early_stopping_50test_data.p experiments/mvn_ngboost_fit_experiments/early_stopping_50/20-01-2025_100_replications/model_test_data